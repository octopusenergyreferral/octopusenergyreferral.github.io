const b=document.body,h=document.getElementById("header"),n=document.getElementById("nav"),l=document.getElementById("logo"),t=document.createElement("div");t.id="titleBar";t.innerHTML=`<a href="#header" class="toggle" aria-label="Toggle navigation menu"></a><span class="title">${l?l.textContent.trim():""}</span>`;b.appendChild(t);t.querySelector(".toggle").onclick=e=>{e.preventDefault();b.classList.toggle("header-visible")};document.onclick=e=>{b.classList.contains("header-visible")&&(!h.contains(e.target)||e.target.tagName==="A")&&b.classList.remove("header-visible")};document.onkeydown=e=>{e.key==="Escape"&&b.classList.remove("header-visible")};document.addEventListener("click",e=>{const a=e.target.closest('a[href^="#"]');if(!a)return;const id=a.getAttribute("href");if(id==="#"||id==="#header")return;const s=document.querySelector(id);if(s){e.preventDefault();const o=window.innerWidth<=1024?44:0;window.scrollTo({top:s.offsetTop-o,behavior:"smooth"});n&&(n.querySelectorAll("a").forEach(x=>x.classList.remove("active")),a.classList.add("active"))}});if(n){const secs=[];n.querySelectorAll('a[href^="#"]').forEach(a=>{const s=document.querySelector(a.getAttribute("href"));if(s&&s.id)secs.push({el:s,link:a,id:s.id})});const upd=()=>{const st=window.scrollY+120;let cur=secs[0];for(const s of secs){if(s.el.offsetTop<=st)cur=s}n.querySelectorAll("a").forEach(x=>x.classList.remove("active"));if(cur&&cur.link)cur.link.classList.add("active")};window.addEventListener("scroll",upd,{passive:true});upd();secs.forEach(s=>s.el.classList.remove("inactive"))}if(h){let tx=0;h.ontouchstart=e=>{tx=e.touches[0].pageX};h.ontouchmove=e=>{if(tx&&tx-e.touches[0].pageX<-50){b.classList.remove("header-visible");tx=0}}}requestAnimationFrame(()=>b.classList.remove("is-preload"));
